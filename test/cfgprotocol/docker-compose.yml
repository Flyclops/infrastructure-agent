version: '3.1'

services:
  minimal-agent:
    build:
      context: ../../
      dockerfile: test/proxy/Dockerfile_agent
    image: minimal-agent
    volumes:
      - ./agent:/etc/newrelic-infra/in
    links:
      - http-proxy
    ports:
      - "4445:4445"
    command: ["/agentservice"]

  http-proxy:
    build:
      context: ../../
      dockerfile: test/proxy/Dockerfile_proxyhttp
    image: proxyhttp
    ports:
      - "3128:3128"

  https-proxy:
    build:
      context: ../../
      dockerfile: test/proxy/Dockerfile_proxyhttps
    image: proxyhttps
    ports:
      - "3129:3129"

  fake-collector:
    build:
      context: ../../
      dockerfile: test/proxy/Dockerfile_collector
    image: fake-collector
    ports:
      - "4444:4444"
